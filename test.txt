function Create_vSwitch {
    # Prompt the user for virtual switch and port group names
    $vSwitchName = Read-Host "Please enter the name for the new virtual switch"
    $portGroupName = Read-Host "Please enter the name for the new port group"

    try {
        Write-Host "Creating virtual switch: $vSwitchName"
        Write-Host "Creating port group: $portGroupName"

        # Create the virtual switch on the specified host
        New-VirtualSwitch -VMHost '192.168.7.20' -Name $vSwitchName

        # Create the port group on the newly created virtual switch
        Get-VMHost '192.168.7.20' | Get-VirtualSwitch -Name $vSwitchName | New-VirtualPortGroup -Name $portGroupName

        Write-Host "Successfully created $vSwitchName and $portGroupName."
    }
    catch {
        Write-Host "Error with virtual switch and port group creation: $_"
        exit
    }
}



function Get-IP([string] $vCenter, [string] $virtualMachine){
    $vmInfo = Get-VM -Name $virtualMachine
    Get-VM -Name $vmInfo | Select-Object Name, @{N="IP Address";E={@($_.Guest.IPAddress[0])}}
    Get-NetworkAdapter -Server $vCenter -VM $vmInfo.Name | Format-Table -AutoSize
}
