function Create_Unique_vSwitchAndPortGroup{
    param(
        [string] $Unique_vSwitchName = $(Read-Host -Prompt "Enter the name for the vSwitch"),
        [string] $Unique_portGroupName = $(Read-Host -Prompt "Enter the name for the port group")
    )
    try{
        Write-Host "Creating vSwitch: $Unique_vSwitchName"
        Write-Host "Creating port group: $Unique_portGroupName"

        New-UniqueVirtualSwitch -VMHost '192.168.7.20' -UniqueName $Unique_vSwitchName
        Get-VMHost '192.168.7.20' | Get-UniqueVirtualSwitch -UniqueName $Unique_vSwitchName | New-UniqueVirtualPortGroup -UniqueName $Unique_portGroupName

        Write-Host "vSwitch and port group created successfully."
    }
    catch{
        Write-Host "Error with unique virtual switch and port group creation."
        exit
    }
}

Create_Unique_vSwitchAndPortGroup


function Get-IP([string] $vCenter, [string] $virtualMachine){
    $vmInfo = Get-VM -Name $virtualMachine
    Get-VM -Name $vmInfo | Select-Object Name, @{N="IP Address";E={@($_.Guest.IPAddress[0])}}
    Get-NetworkAdapter -Server $vCenter -VM $vmInfo.Name | Format-Table -AutoSize
}
